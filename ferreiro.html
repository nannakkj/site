<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ferreiro</title>
  <link rel="stylesheet" href="./css/ferreiro.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400..900&family=Edu+QLD+Hand:wght@400..700&display=swap"
    rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=IM+Fell+English:ital@0;1&display=swap" rel="stylesheet">
</head>

<body>
  <section>
    <div class="bg"><img src="./img/fundo_ferreiro.png"></div>
    <a href="./mapa.html">
      <div class="voltar"><ion-icon name="return-down-back-outline"></ion-icon></div>
    </a>
    <div class="prateleira" id="prateleira1">
      <div class="carrosel">
        <div class="carrosel_track">
          <div class="carrosel_item espadas"><img src="./img/espada1.png" alt="Imagem 1"></div>
          <div class="carrosel_item espadas"><img src="./img/espada2.png" alt="Imagem 2"></div>
          <div class="carrosel_item espadas"><img src="./img/espada3.png" alt="Imagem 3"></div>
          <div class="carrosel_item espadas"><img src="./img/espada4.png" alt="Imagem 4"></div>
        </div>
      </div>
    </div>
    <div class="precosw">
      <div class="backsw"><ion-icon name="return-down-back-outline"></ion-icon></div>
    </div>
    <div class="precoar">
      <div class="backar"><ion-icon name="return-down-back-outline"></ion-icon></div>
    </div>
    </div>
    <div class="swordic">âš”</div>
    <div class="armoric"><img src="./img/armor.png" alt=""></div>
    <div class="prateleira" id="prateleira2">

    </div>

  </section>

  <script>
    const carrosel = document.querySelector('.carrosel');
    const track = document.querySelector('.carrosel_track');
    let items = Array.from(document.querySelectorAll('.carrosel_item'));

    const itemCount = items.length;
    let itemWidth = carrosel.offsetWidth;

    let isDragging = false;
    let startX = 0;
    let currentTranslate = 0;
    let prevTranslate = 0;
    let animationID = 0;
    let currentIndex = 0;

    function setWidthAndPosition() {
      itemWidth = carrosel.offsetWidth;
      setPositionByIndex();
    }

    setWidthAndPosition();

    items.forEach(item => {
      item.addEventListener('dragstart', e => e.preventDefault());
    });
    carrosel.addEventListener('mousedown', startDrag);
    carrosel.addEventListener('mouseup', endDrag);
    carrosel.addEventListener('mouseleave', endDrag);
    carrosel.addEventListener('mousemove', drag);

    carrosel.addEventListener('touchstart', startDrag);
    carrosel.addEventListener('touchend', endDrag);
    carrosel.addEventListener('touchmove', drag);

    track.style.transform = `translateX(${-itemWidth * currentIndex}px)`;
    prevTranslate = -itemWidth * currentIndex;
    currentTranslate = prevTranslate;

    function startDrag(e) {
      isDragging = true;
      startX = getPositionX(e);
      animationID = requestAnimationFrame(animation);
      carrosel.classList.add('grabbing');
    }

    function endDrag() {
      if (!isDragging) return;
      isDragging = false;
      cancelAnimationFrame(animationID);
      carrosel.classList.remove('grabbing');

      const movedBy = currentTranslate - prevTranslate;

      if (movedBy < -itemWidth / 4 && currentIndex < items.length - 1) {
        currentIndex++;
      } else if (movedBy > itemWidth / 4 && currentIndex > 0) {
        currentIndex--;
      }

      setPositionByIndex();
    }

    function drag(e) {
      if (!isDragging) return;
      const currentPosition = getPositionX(e);
      let nextTranslate = prevTranslate + currentPosition - startX;

      const maxTranslate = 0;
      const minTranslate = -itemWidth * (items.length - 1);

      if (nextTranslate > maxTranslate) {
        nextTranslate = maxTranslate;
      } else if (nextTranslate < minTranslate) {
        nextTranslate = minTranslate;
      }

      currentTranslate = nextTranslate;
    }

    function getPositionX(e) {
      return e.type.includes('mouse') ? e.pageX : e.touches[0].clientX;
    }

    function animation() {
      setSliderPosition();
      if (isDragging) requestAnimationFrame(animation);
    }

    function setSliderPosition() {
      track.style.transform = `translateX(${currentTranslate}px)`;
    }

    function setPositionByIndex() {
      track.style.transition = 'transform 0.3s ease';
      currentTranslate = -currentIndex * itemWidth;
      prevTranslate = currentTranslate;
      setSliderPosition();
    }

    window.addEventListener('resize', () => {
      setWidthAndPosition();
    });

  </script>
  <script>
    const precosw = document.querySelector('.precosw');
    const precoar = document.querySelector('.precoar');
    const swordic = document.querySelector('.swordic');
    const armoric = document.querySelector('.armoric');
    const backsw = document.querySelector('.backsw');
    const backar = document.querySelector('.backar');



    swordic.addEventListener('click', () => {
      armoric.style.animation = 'minie 0.8s ease-out forwards';
      swordic.style.animation = 'minie 0.8s ease-out forwards';
      setTimeout(() => {
      precosw.classList.add('ativo');
      precosw.style.animation = 'armora 0.8s ease-out forwards';
      armoric.classList.add('remove');
      swordic.classList.add('remove');
      }, 300);
    });
    backsw.addEventListener('click', () => {
      precosw.style.animation = 'armore 0.8s ease-out forwards';
      setTimeout(() => {
        precosw.classList.remove('ativo');
        armoric.classList.remove('remove');
        swordic.classList.remove('remove');
      armoric.style.animation = 'minia 0.8s ease-out forwards';
      swordic.style.animation = 'minia 0.8s ease-out forwards';
      }, 750);
    });

    armoric.addEventListener('click', () => {
      armoric.style.animation = 'minie 0.8s ease-out forwards';
      swordic.style.animation = 'minie 0.8s ease-out forwards';
      setTimeout(() => {
        precoar.classList.add('ativo');
        precoar.style.animation = 'armora 0.8s ease-out forwards';
        armoric.classList.add('remove');
        swordic.classList.add('remove');
      }, 300);

    });
    backar.addEventListener('click', () => {
      precoar.style.animation = 'armore 0.8s ease-out forwards';

      setTimeout(() => {
        precoar.classList.remove('ativo');
        armoric.classList.remove('remove');
        swordic.classList.remove('remove');
            armoric.style.animation = 'minia 0.8s ease-out forwards';
      swordic.style.animation = 'minia 0.8s ease-out forwards';
      }, 750);

    });


  </script>

  <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
  <script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>
</body>